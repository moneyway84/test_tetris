<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>테트리스 (파스텔 스타일)</title>
  <style>
    :root {
      --bg: linear-gradient(180deg, #ffe4f1 0%, #ffc1e3 100%);
      --panel: #fff0f6;
      --text: #5c5c5c;
      --accent: #ff80ab;
      --muted: #b08099;
      --grid: #f0d0e0;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: 'Apple SD Gothic Neo','Malgun Gothic',sans-serif;
      background: var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
    }
    .wrap {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 18px;
      width: min(1000px, 96vw);
      padding: 18px;
    }
    .stage {
      background: #fffafa;
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 25px rgba(255,105,180,.25);
      display: grid;
      grid-template-columns: auto;
      justify-items: center;
      position: relative;
    }
    canvas { display: block; image-rendering: pixelated; }
    #board { border-radius: 12px; background: #fef6f9; }

    .side {
      background: var(--panel);
      border-radius: 16px;
      padding: 16px;
      width: 280px;
      display: grid;
      grid-template-rows: auto auto 1fr auto;
      gap: 16px;
      box-shadow: 0 6px 18px rgba(255,105,180,.25);
    }

    .card {
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      box-shadow: inset 0 0 0 1px rgba(255,192,203,.3);
    }
    .h {
      margin: 0 0 8px 0;
      font-size: 14px;
      letter-spacing: .4px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .stat { display: grid; grid-template-columns: 1fr auto; gap: 6px; font-size: 15px; }
    .stat b { font-size: 18px; color: var(--accent); }

    .keys { font-size: 14px; color: var(--muted); line-height: 1.7; }
    kbd {
      background: #ffeaf4;
      padding: 2px 6px; border-radius: 6px; border: 1px solid #ffc1e3; color: #d46a94;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 12px;
    }

    .overlay {
      position: absolute; inset: 0; display: grid; place-items: center;
      background: rgba(255,182,193,.3);
      pointer-events: none; border-radius: 16px;
    }
    .banner {
      padding: 12px 16px; border-radius: 10px; background: rgba(255,240,245,.9);
      border: 1px solid rgba(255,192,203,.5); backdrop-filter: blur(6px);
      color: #d46a94; font-weight: 600; letter-spacing: .3px;
      box-shadow: 0 6px 20px rgba(255,182,193,.35);
    }

    .footer { text-align: center; font-size: 12px; color: var(--muted);}

    @media (max-width: 820px) {
      .wrap { grid-template-columns: 1fr; }
      .side { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stage">
      <canvas id="board" width="320" height="640"></canvas>
      <div class="overlay" id="overlay" hidden>
        <div class="banner" id="banner">일시정지</div>
      </div>
    </div>
    <aside class="side">
      <div class="card"><h3 class="h">다음 블록</h3><canvas id="next" width="120" height="120"></canvas></div>
      <div class="card"><h3 class="h">홀드</h3><canvas id="hold" width="120" height="120"></canvas></div>
      <div class="card"><h3 class="h">상태</h3>
        <div class="stat"><span>점수</span><b id="score">0</b></div>
        <div class="stat"><span>라인</span><b id="lines">0</b></div>
        <div class="stat"><span>레벨</span><b id="level">1</b></div>
      </div>
      <div class="card keys">
        <div><kbd>← →</kbd> 이동 · <kbd>↓</kbd> 소프트드랍</div>
        <div><kbd>↑</kbd> 시계회전 · <kbd>Z</kbd> 반시계</div>
        <div><kbd>스페이스</kbd> 하드드랍</div>
        <div><kbd>C</kbd> 홀드 · <kbd>P</kbd> 일시정지 · <kbd>R</kbd> 리셋</div>
      </div>
      <div class="footer">Made in vanilla JS · pastel theme</div>
    </aside>
  </div>

  <script>
    // JS 로직은 기존과 동일, 블록 색상만 파스텔로 변경
    const COLS = 10, ROWS = 20, SIZE = 32;
    const board = Array.from({length: ROWS}, () => Array(COLS).fill(0));
    const canvas = document.getElementById('board');
    const ctx = canvas.getContext('2d');
    const nextCanvas = document.getElementById('next');
    const nctx = nextCanvas.getContext('2d');
    const holdCanvas = document.getElementById('hold');
    const hctx = holdCanvas.getContext('2d');
    const $score = document.getElementById('score');
    const $lines = document.getElementById('lines');
    const $level = document.getElementById('level');
    const overlay = document.getElementById('overlay');
    const banner = document.getElementById('banner');

    const COLORS = {
      0: 'transparent',
      I: '#a5f3fc', O: '#fef08a', T: '#e9d5ff', S: '#bbf7d0', Z: '#fecdd3', J: '#bfdbfe', L: '#fed7aa'
    };
    const SHAPES = {
      I: [[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],
      O: [[1,1],[1,1]],
      T: [[0,1,0],[1,1,1],[0,0,0]],
      S: [[0,1,1],[1,1,0],[0,0,0]],
      Z: [[1,1,0],[0,1,1],[0,0,0]],
      J: [[1,0,0],[1,1,1],[0,0,0]],
      L: [[0,0,1],[1,1,1],[0,0,0]]
    };

    let bag = [];
    function refillBag(){
      bag = ['I','O','T','S','Z','J','L'];
      for(let i=bag.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [bag[i], bag[j]] = [bag[j], bag[i]];
      }
    }
    function nextFromBag(){ if(bag.length===0) refillBag(); return bag.pop(); }

    let piece = null;
    let nextType = nextFromBag();
    let holdType = null;
    let canHold = true;
    let score = 0, lines = 0, level = 1;
    let dropInterval = 800;
    let lastDrop = 0;
    let paused = false;
    let over = false;

    function shapeMatrix(type){ return SHAPES[type].map(r=>r.slice()); }
    function newPiece(){
      const type = nextType;
      nextType = nextFromBag();
      const m = shapeMatrix(type);
      return {type, m, x: Math.floor((COLS - m[0].length)/2), y: -1};
    }
    function collide(grid,p){
      for(let j=0;j<p.m.length;j++) for(let i=0;i<p.m[j].length;i++){
        if(!p.m[j][i]) continue;
        const nx = p.x+i, ny=p.y+j;
        if(nx<0||nx>=COLS||ny>=ROWS) return true;
        if(ny>=0 && grid[ny][nx]) return true;
      }
      return false;
    }
    function merge(grid,p){
      for(let j=0;j<p.m.length;j++) for(let i=0;i<p.m[j].length;i++){
        if(p.m[j][i]){ const nx=p.x+i, ny=p.y+j; if(ny>=0) grid[ny][nx]=p.type; }
      }
    }
    function clearLines(){
      let cleared=0;
      outer: for(let y=ROWS-1;y>=0;y--){
        for(let x=0;x<COLS;x++) if(!board[y][x]) continue outer;
        board.splice(y,1);
        board.unshift(Array(COLS).fill(0));
        cleared++; y++;
      }
      if(cleared>0){
        lines+=cleared;
        score+=[0,100,300,500,800][cleared]*level;
        level=1+Math.floor(lines/10);
        dropInterval=Math.max(80,800-(level-1)*60);
        updateHUD();
      }
    }
    function hardDrop(){ while(!collide(board,{...piece,y:piece.y+1})) piece.y++; lockPiece(); }
    function softDrop(){ if(!collide(board,{...piece,y:piece.y+1})) piece.y++; else lockPiece(); }
    function move(dx){ if(!collide(board,{...piece,x:piece.x+dx})) piece.x+=dx; }
    function rotatePiece(){
      const m=piece.m; const N=m.length;
      const r=Array.from({length:N},(_,y)=>Array.from({length:N},(_,x)=>m[N-1-x][y]));
      const np={...piece,m:r};
      if(!collide(board,np)) piece=np;
    }
    function hold(){ if(!canHold) return; canHold=false;
      if(holdType==null){ holdType=piece.type; piece=newPiece(); }
      else { [holdType,piece]=[piece.type,{type:holdType,m:shapeMatrix(holdType),x:3,y:0}]; }
    }
    function lockPiece(){ merge(board,piece); clearLines(); piece=newPiece(); canHold=true; if(collide(board,piece)){ over=true; banner.textContent='게임 오버'; overlay.hidden=false; }}

    function drawCell(x,y,color){ ctx.fillStyle=color; ctx.fillRect(x*SIZE,y*SIZE,SIZE,SIZE); ctx.strokeStyle='rgba(0,0,0,.1)'; ctx.strokeRect(x*SIZE,y*SIZE,SIZE,SIZE); }
    function draw(){ ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let y=0;y<ROWS;y++) for(let x=0;x<COLS;x++){ if(board[y][x]) drawCell(x,y,COLORS[board[y][x]]); }
      if(piece) for(let j=0;j<piece.m.length;j++) for(let i=0;i<piece.m[j].length;i++) if(piece.m[j][i]) drawCell(piece.x+i,piece.y+j,COLORS[piece.type]); }

    function updateHUD(){ $score.textContent=score; $lines.textContent=lines; $level.textContent=level; }

    function loop(ts){ if(!lastDrop) lastDrop=ts; if(!paused&&!over){ if(ts-lastDrop>dropInterval){ softDrop(); lastDrop=ts; } draw(); } requestAnimationFrame(loop); }

    window.addEventListener('keydown',e=>{ if(over) return; switch(e.code){ case 'ArrowLeft':move(-1);break; case 'ArrowRight':move(1);break; case 'ArrowDown':softDrop();break; case 'ArrowUp':rotatePiece();break; case 'Space':hardDrop();break; case 'KeyC':hold();break; case 'KeyP':paused=!paused; overlay.hidden=!paused; banner.textContent=paused?'일시정지':'일시정지';break; case 'KeyR':location.reload();break; }});

    refillBag(); piece=newPiece(); updateHUD(); requestAnimationFrame(loop);
  </script>
</body>
</html>
